- content_for :page_title, '求人情報の編集'

.admin-actions
  = link_to '詳細を見る', admin_job_path(@job), class: 'btn btn-secondary'
  = link_to '一覧に戻る', admin_jobs_path, class: 'btn btn-secondary'

.admin-form-container
  = form_with model: [:admin, @job], local: true, multipart: true, class: 'admin-form' do |form|
    - if @job.errors.any?
      .alert.alert-danger
        %h4= pluralize(@job.errors.count, "個のエラー") + "があります："
        %ul
          - @job.errors.full_messages.each do |message|
            %li= message

    .form-group
      = form.label :title, '求人タイトル', class: 'form-label required'
      = form.text_field :title, class: 'form-control'

    .form-group
      = form.label :job_type, '職種', class: 'form-label required'
      = form.text_field :job_type, class: 'form-control'

    .form-group
      = form.label :description, '募集内容', class: 'form-label required'
      = form.text_area :description, class: 'form-control', rows: 8

    .form-group
      = form.label :capacity, '定員', class: 'form-label'
      = form.text_field :capacity, class: 'form-control'

    .form-group
      = form.label :salary_range, '想定年収', class: 'form-label'
      = form.text_field :salary_range, class: 'form-control'

    .form-group
      = form.label :expectations, '期待していること', class: 'form-label'
      = form.text_area :expectations, class: 'form-control', rows: 5

    .form-group
      = form.label :senior_message, '同じ職種の先輩からのエール', class: 'form-label'
      = form.text_area :senior_message, class: 'form-control', rows: 5

    .form-group
      = form.label :hero_images, 'メイン画像・イラスト（最大3枚）', class: 'form-label'
      - if @job.hero_images.any?
        .current-images
          %p 現在の画像:
          .images-grid
            - @job.hero_images.each_with_index do |hero_image, index|
              .image-item
                = image_tag hero_image, class: 'preview-image', style: 'max-width: 200px; height: auto; margin: 10px;'
                = link_to '削除', admin_job_destroy_image_path(@job, hero_image.id), method: :delete, 
                          class: 'btn btn-sm btn-danger delete-image', 
                          data: { confirm: 'この画像を削除しますか？' }
      .image-upload-container
        = form.file_field :hero_images, class: 'form-control', accept: 'image/*', multiple: true, data: { max_files: 3 }
        %small.form-text.text-muted 新しい画像を追加できます（最大3枚まで）

    .form-group
      = form.label :detail_images, '詳細画像・イラスト（最大5枚）', class: 'form-label'
      - if @job.detail_images.any?
        .current-images
          %p 現在の画像:
          .images-grid
            - @job.detail_images.each_with_index do |detail_image, index|
              .image-item
                = image_tag detail_image, class: 'preview-image', style: 'max-width: 200px; height: auto; margin: 10px;'
                = link_to '削除', admin_job_destroy_image_path(@job, detail_image.id), method: :delete, 
                          class: 'btn btn-sm btn-danger delete-image', 
                          data: { confirm: 'この画像を削除しますか？' }
      .image-upload-container
        = form.file_field :detail_images, class: 'form-control', accept: 'image/*', multiple: true, data: { max_files: 5 }
        %small.form-text.text-muted 新しい画像を追加できます（最大5枚まで）

    .form-group
      = form.label :display_order, '表示順', class: 'form-label'
      = form.number_field :display_order, class: 'form-control'

    .form-group
      .form-check
        = form.check_box :published, class: 'form-check-input', id: 'job_published'
        = form.label :published, '公開する', class: 'form-check-label', for: 'job_published'

    .form-actions
      = form.submit '求人情報を更新', class: 'btn btn-primary'
      = link_to 'キャンセル', admin_jobs_path, class: 'btn btn-secondary'